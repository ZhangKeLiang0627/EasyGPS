#ifndef CONFIGWIFI_H
#define CONFIGWIFI_H
#include <WiFi.h> // 引入 WiFi 库
#include "../Utility/BM8563/I2C_BM8563.h"
#include <DNSServer.h>
#include <WebServer.h>
#include "HttpClient.h"
#include <ESPmDNS.h>     //用于设备域名 MDNS.begin("esp32")
#include <Preferences.h> //用于参数数据的

static String WiFi_Name = "none";
static String WiFi_Pass = "none";
class ConfigWiFi
{
public:
    bool AutoTime = true;
    bool wifiEnabled = false;
    bool OnAP = false;
    const char *AP_SSID = "Hugo@kkl-AP";
    ConfigWiFi();
    ~ConfigWiFi();
    void Init();
    void enableWiFi();
    void disableWiFi();
    bool isWiFiEnabled() const;
    bool isConnected() const;
    void APMode();
    bool APClose();
    void NtpTimeCorr();
    void WiFiloop();
    bool enableIPv6();
    char *WiFiN();
    char *WiFiMac();
    char *LocalIP();
    char *GateWay();
    String GetIPv6();

private:
    const char *HOST_NAME = "Chappie-Hugokkl";
    const char *ntpServer = "ntp.aliyun.com";
};
#define WiFi_LOG(format, args...) printf(format, ##args)

/* ----------  ---------- */

#define ROOT_HTML "<!DOCTYPE html><html lang=\"en\"><head><meta http-equiv=\"Content-Type\"content=\"text/html;charset=UTF-8\"><title>WiFi配置页面</title><meta name=\"viewport\"content=\"width=device-width,initial-scale=1.0,minimum-scale=0.3,maximum-scale=0.8,user-scalable=no\"/><style>body{color:rgba(67,67,67,0.9);background-image:linear-gradient(145deg,rgba(255,150,205,0.5),#EF96C5,#EAD6EE,#EEBD89,#F9957F);background-size:800%;animation:bganimation 15s infinite;max-width:99%;height:50em}@keyframes bganimation{0%{background-position:0%50%}50%{background-position:100%50%}100%{background-position:0%50%}}#lable{font-size:calc(3em)}#box{display:flex;align-items:center;justify-content:flex-start;flex-direction:column}div{margin:auto;left:0;top:0;right:0;bottom:0}p{line-height:0}.scan-btn{list-style:none;display:block;border:0;border-radius:25px;cursor:pointer;font-size:18px;height:50px;width:135px;line-height:45px;margin:18px auto;padding:0 30px;box-shadow:3px 3px 3px 3px rgba(141,124,124,0.2);background-color:rgba(255,255,255,0.20)}@keyframes btn_style{from{height:50px;width:135px}to{height:50px;width:50px}}#Scan_Box{height:20em;max-width:80%}#scan_list{margin-top:20px;box-sizing:border-box;border-radius:18px;width:19em;background:rgba(255,255,255,0.30);backdrop-filter:blur(1em)}#scan_list>li{line-height:32px;position:relative;cursor:pointer;display:block;padding:8px 15px;font-family:'Final Frontier'}#scan_list>li:first-child{border-top:0;border-top-left-radius:20px;border-top-right-radius:20px}#scan_list>li:last-child{border-bottom-left-radius:20px;border-bottom-right-radius:20px}#scan_list>li:hover{background:#d0d3d4}.wifi-logo{position:absolute;top:14px;height:18px}.wifi-lock{position:absolute;top:0.9em;right:1.2em;width:18px;height:18px}.encrytype{color:#999;display:inline-block;z-index:1;position:absolute;right:16px}.ssid_name{margin-left:3em;font-size:16px}#spot{background-color:#0093E9;display:none;height:50px;width:50px;border-radius:50px;animation:spot 1.2s infinite}@keyframes spot{0%{-webkit-transform:scale(0.1);transform:scale(0.1);opacity:1}50%{-webkit-transform:scale(1);transform:scale(1);opacity:0.5}100%{-webkit-transform:scale(0.1);transform:scale(0.1);opacity:1}}#password_Box{position:fixed;height:12em;width:25em;padding:1em;background:rgba(255,255,255,0.80);border-radius:2em;display:none}#inp_password{margin-left:2.2em;font-size:1.5em;border-style:none;border-radius:0.2em;margin-top:0.5em}.sumit{border-style:none;font-size:1em;margin-top:1.5em;height:2.3em;width:10.3em;margin-left:7.7em;background:#0093E9;border-radius:1em;color:#fff}.sumit:hover{background:#49b3fc;cursor:pointer}#close{margin-left:11.2em;font-size:2.0em;right:0;cursor:pointer}.tick{stroke-dasharray:320;stroke-dashoffset:300;animation:tick 2.1s forwards}#click_success{width:15em;height:18em;align-items:center;flex-direction:column;display:none}@keyframes tick{0%{stroke-dashoffset:300}50%{stroke-dashoffset:150}100%{stroke-dashoffset:0}}</style></head><body><div id=\"backgroud\"><div id=\"box\"><p id=\"lable\">WiFi配置</p><p style=\"color:#4f4f4f;text-align:center;\">当前设备类型:ESP32S3仅支持2.4G</p><p style=\"color:rgba(91,91,91,0.9);font-size:2em\">点击开始搜索WiFi</p><button style=\"color:rgb(91,91,91);\"onclick=\"scan()\"id=\"scan-btn\"class=\"scan-btn\">扫描WIFI</button><!--click--></div><div id=\"Scan_Box\"><div id=\"spot\"></div><div id=\"scan_list\"></div><!--如果传输回来成功的话显示连接成功--><div id=\"click_success\"><svg width=\"12em\"height=\"12em\"><circle fill=\"#008EFF\"stroke-opacity=\"0.5\"stroke-width=\"8\"cx=\"100\"cy=\"100\"r=\"90\"/><polyline fill=\"none\"stroke-width=\"10\"stroke=\"#fff\"class=\"tick\"points=\"52,100 92,140 157,64\"stroke-linecap=\"round\"stroke-linejoin=\"round\"/></svg><h4 style=\"line-height:0.1em\">连接成功,请手动关闭AP</h4></div></div><div id=\"password_Box\"><div id=\"close\"onclick=\"back()\">×</div><!--click--><p id=\"text\"style=\"text-align:center;font-family:'Final Frontier';font-size:1.3em;\">test</p><input type=\"password\"id=\"inp_password\"><!--<button id=\"config\"class=\"sumit\"type=\"submit\">好</button>--><button class=\"sumit\"id=\"config\">好</button><!--click--></div></div><div style=\"border:3px dashed#467eff;width:13em;text-align:center\"><p style=\"font-size:1.2em;font-family:'Final Frontier'\">Web Design By<span style=\"color:#467eff\">Yeely</span></p></div><script>let flag=0;let LockSymbol=\"<img class='wifi-lock'src='data:image/png;base64,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'>\";let WiFiFull=\"<img class='wifi-logo'src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAArBAMAAADWAfZiAAAAIVBMVEVkZGRHcEzj4+N4eHisrKySkpJ4eHiXl5eHh4eAgIBqamownJsxAAAACnRSTlP+ABXfPZL6ZK/JavXHrwAAAeVJREFUOMt9k8tPAjEQxichMdpbyxIft4rP2wo+uUFQzqj44GSibtSbhojxZoyKnNRED542IUTcv9KZtstugbWnbn+dzjff7AC3lpTS+oZoKypH+Xx+q9aQI7DY/gp8oBVc7g9h51Eztdha0caLBbDW700cL7omLAgM71xHePJEsdNWs9Fsvno+MIwvhth5U/dfTMK5O5WpJw2+B7x/UYzKcQ6In2m8TJo3LDvEHiWrEhZvmGojPA9v3ZJ8wju46UqdtLV+2tISRB2PVzg4qDpFJ+LuytR0SJcdF1hKgnBVEu48R6YomUsYJoFnoUu0HTetR7wOOZJWwL1o26ae4/uZjqTC5pRQrI5t1hqVGvWGwSoelkLPMz6e/e6bzpJpLOY5b4f5tGnf+Dke4WmLEmfA3vt4wZTOy+VyybTQz/WxcNkHBR17fuB90sVlrDnKnaXSJ7/1/6Q63c7FpImqEaQ5FS0HfuR6ZMrP8I88RS8HnheYTttY0A910ZidrVBrekPY1Ubj7oAZ2fHHszBhjMFO54aHyH3oy+gHx5TP0zgcPdETu6MmFI0pAOsUEwaYSsfqukk4o+esmoDTjLC/koCFmtOUTMo9E47WaMwxfCxZOU9DZNgIzN0J+R/O2sGDWMh/8eD6A1I5i3duz7rVAAAAAElFTkSuQmCC'>\";let WiFiMid=\"<img class='wifi-logo'src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAAsCAMAAAAO9CvbAAAAP1BMVEVHcEzf39/R0dHu7u52dnaJiYmAgIBmZmbc3Nza2tqSkpKXl5elpaXd3d3g4ODe3t5xcXHe3t7d3d3d3d1iYmIxMAOHAAAAE3RSTlMAiTAN/LXT/v0akWpOY0W54NjrSWdzrwAAAjFJREFUSMe1lokWoyAMRcsmsikI//+tEwIRHeu09pzJ6are8PISaV+v/xCcL6xF4PwBZxa2plxjnmd8TytbxDdkWDfkKklRv25r+IAuSOL18yVyYvxfaCdn0lu/5oOAnMItelCZt4RurSmleVSR87q8qZV1sfBI4PDRIHCQbaQCcPMXGzp3b0w1sqffTleYdW7C8hrqimNVcWpEIg/YYSBSqyjPd92gHGHr5SfyfSGLmTgsxY0JzjlvjDlbU92EhZYTe/DBeDtJqSHgRcrJ+iGfryg9N3pDIXkvQ3gldYHQGO1TVIMP2Mqcef88b9Q94aImrtP4LDo6krakSjPKlCitmzSRpQcdKHpye3fyrjSwzvIdrYtLGWOspZeBk8nsMmdWt3XgtZrkl5cQi6/mIY8p3E0vbS2t0lK58wRyp2TpJ+11eqrklrxI9e7GMw2HBOq6LXBZWlnq7p7lSmPXSjQX0QrTSr8fEN5hjEt9REvUm8wKzkxkIq8uNevAOxJjJjig3upS0tIS6G+hduthg7phYbjIG+rsmBetuvoPu6CjrtCEtdbLb3ZvKzsK1dagASt383GesjYrMGJwKxsBA0by7SdYIasnfzjmO64+Lg2DVqS9+vANW7sRr974+BULN0jvCvdWQeE0NY9+ZC1uYlra57/PgjwG88RD1sixj5XJPINtabtemw/3VHUZm+dj3SL2oQTVPzgWu2Hxl/9DTfkv6+70jyzuOo+9OtDWvP5b/AEEbikOWznHDAAAAABJRU5ErkJggg=='>\";let WiFiLow=\"<img class='wifi-logo'src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAArCAMAAAAT8RtjAAAAP1BMVEVHcEzs7Ozj4+NtbW3W1tbe3t7a2trd3d1lZWXf39/g4ODi4uKLi4vg4OB2dnaIiIiioqJ7e3t3d3fd3d1iYmIuIQKqAAAAE3RSTlMADh39N+BM+/21f2SCmaTKlvjg1bcnLQAAAgpJREFUSMe1lYmSrCAMRQ2rbC4t//+tAwmgjvRr7VeTUqtETm4ICQ7DnxhTQgiVr4eYNVLqrZo01gp2hxTOFExvGo1etFEfSHAGJ54MB/Itg/oXKhu5HU0TnWJ5J1/QjcD0lIasDpDPLi4KmufJ4Bi0DDHmnJFb82x+5w6Cbt9sd29U0A13V1kct2e30FvXWdxW1PQLorkQJs/Mk8WZ/Y0yAOWcAoAjn9RJXFUWX6XaZZjNSS5ZliaIY3ZISuPCBQUSWmygDGWmlFj+KpGnKarQ+IKubMtq2ZVDhdFT2uqeyVPcjWXhUA+HAqPbFXEwjU1qdePcvpepVFI3pe7C9kI2DVXEqst+hEZKqxiqQO7QgCvBK7zpC1V3QV5qLOew1ILpNrYrSdQWun1eCniTnc+iyPZRTKYh96bzDRcsxR6pn+Zk3u8nkNqr40rvC/LTysc45ovz1YtDA705DmxNpX/xGBNXLEY+ixq6+3B4TnwHx5EC4B7uHJ+KU7gRxWsEcZxv0J6UUqivlCy/zCsv/Avu6Oa5q2dlLhMzxRJfH5WnHCP3pzoScxKPfBlu0JFfTiPPb7GJXkXrFajrXNbl3o+uADlXKWvFk3r0q5w5bRX3j//OYo2tRmZ4xsJaKyXj00PlCVkqTr48jXuiYsnPxyzRuTbG5wmr2pEvw/AtHf0wfEt/q4v0f7Cf7AeBdSgaJTCRHQAAAABJRU5ErkJggg=='>\";let WiFiU=\"<img class='wifi-logo'src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAArBAMAAADWAfZiAAAAKlBMVEXc3NxHcEzb29tkZGTe3t7g4ODq6urf39/a2trf39/i4uJ3d3eQkJCNjY3QLHilAAAADnRSTlP+AAP+lGcU10G3KtqS3sn92jQAAAIZSURBVDjLdZOxbhRBDIZd7ClcaSsZnSIaj0JIRLllKDiJ6ESXlRIRpduGIGhOiBCRikN34USVIgcK3RYRD3ASBR1KCRVPhO3Zzc1ODjc7s9/YY/8eAzbmuVmRv/0JzS9Gmu4/Fds9l6MJFnr9FWp7e677CBO75xDZLtccAu09gZa9HwVu+A4FyCpqMLtAu7PJwcFkPIy4YMI9g0elJszsJnY6Y1ZM/F13s0rqMUPctDzPSDE/0PU3Il+bnELjhUcg0lBnIppfiMbGM2Tgh7I4QS+FuMmzq6vZYYnKNZ8vBE4S7ZaETNchZclRsmV3ISsEp5fodrAoeqbHVyU6AR/DPeKm9No6SMQfoC+p4WnFhIlsJ3JZL7PCXkgkKx0uj6afx+ESKbqWRb5rdUqhs5ZiwbWoGEJ3Sm/KsF8f2PVNS2g7tMDbe1LZ9Hifm4YeS+SKVJjpR1XNrw81euMt0hRa3PgCVk6t6A1YiZ7Ddlx6NiJpRD96TNQqXVrBPVx4iwbInxaivCNsvVTZrYUnGF5zgZSMgYbOZAJeDSx8MiXa105pw7KnnUywNC4rg2pSwRtKZ8wNizB60oFuyQlGfimBt37/kaK5ojS4Ng635nm+M+LbAYywDu1NLvYYkfEuRryfm/2KfsX4UcB/l2Pyc6U7JS/39ub+k/4TnKjOfDlGfp3nP2LnNiY3b92cYHFvOyeYXNs5wchtZ/wHCeuN70G4JAkAAAAASUVORK5CYII='>\";let ssid_name;let password;function back(){document.getElementById(\"password_Box\").style.display=\"none\";document.getElementById(\"inp_password\").value=\"\"}function connect(){var xmlhttp=new XMLHttpRequest();var requestString;requestString=\"./configwifi?ssid=\"+ssid_name+\"&password=\"+password;xmlhttp.onreadystatechange=function(){if(xmlhttp.status==201||xmlhttp.responseText==\"false\"){document.getElementById(\"scan-btn\").style.display=\"flex\";document.getElementById(\"scan-btn\").textContent=\"连接失败\";document.getElementById(\"spot\").style.display=\"none\"}else if(xmlhttp.status==200||xmlhttp.responseText==\"true\"){document.getElementById(\"scan-btn\").textContent=\"成功\";document.getElementById('spot').style.display='none';document.getElementById(\"click_success\").style.display=\"flex\";var box=document.createElement(\"div\");box.id='Scan_Box';document.getElementById(\"backgroud\").append(box);var div=document.createElement(\"div\");div.id=\"scan_list\";document.getElementById(\"Scan_Box\").appendChild(div)}};xmlhttp.open(\"GET\",requestString,true);xmlhttp.send()}function wificonfig(name){ssid_name=name;document.getElementById(\"password_Box\").style.display=\"block\";document.getElementById(\"text\").innerHTML=\"请输入\"+ssid_name+\"的密码\";document.getElementById(\"config\").onclick=function(){password=document.getElementById('inp_password').value;if(password.length>=8){document.getElementById('scan-btn').style.display=\"none\";document.getElementById('scan_list').remove('li');document.getElementById('password_Box').style.display=\"none\";connect()}else{if(password.length>=1&&password.length<=7){alert(\"密码不低于8位\")}else{password=\"\";document.getElementById('scan-btn').style.display=\"none\";document.getElementById('scan_list').remove('li');document.getElementById('select_box_city').style.display=\"flex\";document.getElementById('password_Box').style.display=\"none\";document.getElementById('select_box_city').style.display=\"flex\"}}}}function scan(){if(flag>=1){document.getElementById('scan_list').remove();var div=document.createElement('div');div.id='scan_list';document.getElementById('Scan_Box').appendChild(div)}var btn=document.getElementById('spot');btn.style.display='block';document.getElementById('scan-btn').setAttribute(\"disabled\",\"true\");document.getElementById('scan-btn').textContent=\"扫描中\";document.getElementById('scan-btn').style.opacity=\"0.7\";var xml=new XMLHttpRequest();xml.onreadystatechange=function(){if(xml.readyState==4&&xml.status==200){json=JSON.parse(xml.responseText);jjj:for(var i=0;i<json.req.length;i++){for(let j=0;j<json.req.length;j++){if(json.req[i].rssi<json.req[j].rssi&&json.req[i].ssid===json.req[j].ssid){continue jjj}}var list=document.createElement(\"li\");list.setAttribute(\"onclick\",\"wificonfig('\" + json.req[i].ssid + \"')\");if(json.req[i].rssi>=-50){list.innerHTML+=WiFiFull}else{if(json.req[i].rssi>=-65){list.innerHTML+=WiFiMid}else{if(json.req[i].rssi>=-80){list.innerHTML+=WiFiLow}else{list.innerHTML+=WiFiU}}}list.innerHTML+=\"<span class='ssid_name'>\"+json.req[i].ssid+\"</span>\";if(json.req[i].encryptionType>0){list.innerHTML+=LockSymbol}document.getElementById(\"scan_list\").appendChild(list);btn.style.display=\"none\"}document.getElementById('scan-btn').textContent=\"重新扫描\";document.getElementById('scan-btn').removeAttribute(\"disabled\");document.getElementById('scan-btn').style.opacity=\"1\";flag++}};xml.open(\"GET\",\"/scanWiFi\",true);xml.send()}</script></body></html>"

#endif
